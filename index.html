<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>

    </style>
</head>
<body>
    <section>
        <button class="add" onclick="addRow();">추가하기</button>
        <ul>
            <li>1번 아이템</li>
        </ul>
    </section>
    <script>
        //감지할 타겟 정해서
        const target = document.querySelector('ul');
        //뮤테이션옵저버 선언해주고 안에 화살표함수로 감지될때마다 명령
        const observer = new MutationObserver((mutations) => {
            alert('DOM 감지!');
        })

        //속성 중 최소한 childList, attributes, characterData는 true로 설정해야 한다. (여기선 ul의 자식들이 추가되는거라 childList만 써도 감지를 하네??)
        const option = {
            attributes: true, //내 속성 변화 감지
            childList: true, // 자식이 바뀌는거 감지
            charcterData: true // 내 데이터 변화 감지
        }

        //대상 타겟에 감시자 보내기
        observer.observe(target, option);

        function addRow(){
            const list = document.querySelector('ul');
            let lastRow = document.querySelector('li:last-child');
            let newNum = parseInt(lastRow.textContent.replace(/[^0-9]/g, '')) + 1;

            let row = document.createElement('li');

            row.textContent = newNum + '번째 아이템';

            list.appendChild(row);
        }
    </script>
</body>
</html>